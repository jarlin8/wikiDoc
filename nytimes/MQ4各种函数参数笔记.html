<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-nytimes/MQ4各种函数参数笔记" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">MQ4函数解析笔记 | wikiDoc</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://wiki.ssgg.net/nytimes/MQ4各种函数参数笔记"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="MQ4函数解析笔记 | wikiDoc"><meta data-rh="true" name="description" content="关闭订单的函数OrderClosePrice()"><meta data-rh="true" property="og:description" content="关闭订单的函数OrderClosePrice()"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://wiki.ssgg.net/nytimes/MQ4各种函数参数笔记"><link data-rh="true" rel="alternate" href="https://wiki.ssgg.net/nytimes/MQ4各种函数参数笔记" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://wiki.ssgg.net/nytimes/MQ4各种函数参数笔记" hreflang="x-default"><script src="https://niu.fendou.la/wikiPrevBox/wikiPreviewBox.min.js" defer="defer" data-domain="niu.fendou.la"></script>
<script src="https://maxkb.ifttt.fun/api/application/embed?protocol=https&amp;host=maxkb.ifttt.fun&amp;token=329b39a217072dc5" async defer="defer" data-domain="maxkb.ifttt.fun"></script><link rel="stylesheet" href="/assets/css/styles.78a9e8db.css">
<script src="/assets/js/runtime~main.05b38c65.js" defer="defer"></script>
<script src="/assets/js/main.7fb5fea4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="wikiDoc Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="wikiDoc Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><div class="navbar__item"><h1 class="font-extrabold"><a>WikiDoc</a></h1></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">做菜之前</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/tips">🥡 吃什么?</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/tips/learn">🛠 学习操作</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/tips/advanced">🥗 大厨必备</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">食谱</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/dishes/aquatic">🍤 水产</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/dishes/breakfast">🍜 早餐</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/dishes/condiment">🍛 调味</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/dishes/dessert">🧀 甜品</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/dishes/drink">🥤 饮料</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/dishes/meat_dish">🥩 肉类</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/dishes/semi-finished">🍖 半成品</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/dishes/soup">🥘 汤类</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/dishes/staple">🍚 主食</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/dishes/vegetable_dish">🥦 蔬菜</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">EXNESS</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/exness-trader">💯 EXNESS客户帮助</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/exness-agent">🎯 EXNESS代理帮助</a></li></ul></div></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为暗黑模式）" aria-label="切换浅色/暗黑模式（当前为暗黑模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input"><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd sidebarWithHideableNavbar_wUlq"><a tabindex="-1" class="sidebarLogo_isFc" href="/"><img src="/img/logo.svg" alt="wikiDoc Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="wikiDoc Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></a><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">目录索引</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/tips">做菜之前</a><button aria-label="展开侧边栏分类 &#x27;做菜之前&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/dishes">食谱主目录</a><button aria-label="展开侧边栏分类 &#x27;食谱主目录&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/chatgpt-edgegpt">ChatGPT的用法合集</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ea-setup">EA相关参数设置</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/exness-agent">EXNESS代理帮助</a><button aria-label="展开侧边栏分类 &#x27;EXNESS代理帮助&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/exness-trader">EXNESS客户帮助</a><button aria-label="展开侧边栏分类 &#x27;EXNESS客户帮助&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/iwencai">2023年牛股追踪</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/nytimes">纽时播报</a><button aria-label="折叠侧边栏分类 &#x27;纽时播报&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/nytimes/MQ4各种函数参数笔记">MQ4函数解析笔记</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/nytimes/concise-vs-natrue">清晰简洁的语言和清晰自然的语言在翻译中都有其优点</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/nytimes/prm写作风格和语调">AI prompt写作风格和语调</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/nytimes/美硕移民">美硕移民</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/nytimes/赴美零碎知识点">赴美留学一些零碎知识</a></li></ul></li></ul></nav><button type="button" title="收起侧边栏" aria-label="收起侧边栏" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/nytimes"><span itemprop="name">纽时播报</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">MQ4函数解析笔记</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>MQ4函数解析笔记</h1>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="关闭订单的函数ordercloseprice">关闭订单的函数<code>OrderClosePrice()</code><a href="#关闭订单的函数ordercloseprice" class="hash-link" aria-label="关闭订单的函数ordercloseprice的直接链接" title="关闭订单的函数ordercloseprice的直接链接">​</a></h2>
<p>详细解释一下 MarketInfo(OrderSymbol(), MODE_BID) MarketInfo(OrderSymbol(), MODE_ASK) 、ask 、bid、与<code>OrderClosePrice()</code>  并解释用哪一个关掉订单最合适?</p>
<p>MarketInfo(OrderSymbol(), MODE_BID) 和 MarketInfo(OrderSymbol(), MODE_ASK) 是用来获取当前交易品种的买入价和卖出价的函数。其中，MODE_BID 表示买入价，MODE_ASK 表示卖出价。买入价指的是交易商愿意以该价格买入货币对的最高价格，卖出价指的是交易商愿意以该价格卖出货币对的最低价格。这两个价格之间的差距称为价差（或者叫做点差），是交易商的盈利来源之一。</p>
<p>OrderClosePrice() 是用来获取已经关闭的订单的平仓价格的函数。当我们使用 OrderClose() 函数来关闭一个订单时，可以通过 OrderClosePrice() 函数来获取该订单的平仓价格。</p>
<p>如果我们想要关闭一个买单，那么应该使用卖出价来计算平仓价格，因为卖出价比买入价更接近当前市场价格，而卖出价也是交易商愿意以该价格卖出货币对的最低价格。因此，在关闭买单时，应该使用 MarketInfo(OrderSymbol(), MODE_ASK) 来获取卖出价，并将其作为平仓价格。</p>
<p>同理，如果我们想要关闭一个卖单，那么应该使用买入价来计算平仓价格，因为买入价比卖出价更接近当前市场价格，而买入价也是交易商愿意以该价格买入货币对的最高价格。因此，在关闭卖单时，应该使用 MarketInfo(OrderSymbol(), MODE_BID) 来获取买入价，并将其作为平仓价格。</p>
<p>直接使用内置函数<code>OrderClosePrice()</code>作为关闭订单的依据，程序会自动判断用Ask还是Bid，无需手动或使用条件语句判断。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="设置止盈和止损">设置止盈和止损<a href="#设置止盈和止损" class="hash-link" aria-label="设置止盈和止损的直接链接" title="设置止盈和止损的直接链接">​</a></h2>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 计算止损和止盈</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">double SL = 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">double TP = 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if(OrderType() == OP_BUY)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    SL = BuyLimitPrice - stopLoss * Point;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    TP = BuyLimitPrice + takeProfit * Point;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">else if(OrderType() == OP_SELL)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    SL = SellLimitPrice + stopLoss * Point;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    TP = SellLimitPrice - takeProfit * Point;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>代码放在策略中需要计算止损和止盈水平的地方。如果希望在每个新的tick到来时重新计算止损和止盈水平，那么可以将其放在<code>ontick()</code>函数中。如果只希望在开仓时计算一次，那么可以将其放在全局中。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="下单的函数及写法">下单的函数及写法<a href="#下单的函数及写法" class="hash-link" aria-label="下单的函数及写法的直接链接" title="下单的函数及写法的直接链接">​</a></h2>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> int BuyTicket = OrderSend(Symbol(), OP_BUYLIMIT, CurrentBuyLotSize, BuyLimitPrice, 3, 0, 0, &quot;WinLimit-Buy&quot;, MagicNumber, 0, clrGreen);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> int SellTicket = OrderSend(Symbol(), OP_SELLLIMIT, CurrentSellLotSize, SellLimitPrice, 3, 0, 0, &quot;WinLimit-Sell&quot;, MagicNumber, 0, clrRed);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>上面这段代码是用来在MetaTrader 4平台上下限价买卖单的。<code>OrderSend</code>函数的各个参数的意义如下：</p>
<ul>
<li><code>Symbol()</code>：交易品种，这里使用当前图表的交易品种。</li>
<li><code>OP_BUYLIMIT</code>：订单类型，这里是限价买单。</li>
<li><code>CurrentBuyLotSize</code>：交易手数。</li>
<li><code>BuyLimitPrice</code>：限价买单的价格。</li>
<li><code>3</code>：止损和止盈的距离，以点为单位。这里设置为3点。</li>
<li><code>0</code>：止损价格。这里设置为0，表示不设止损。</li>
<li><code>0</code>：止盈价格。这里设置为0，表示不设止盈。</li>
<li><code>&quot;WinLimit-Buy&quot;</code>：订单注释。</li>
<li><code>MagicNumber</code>：订单魔数，用于区分不同的策略或EA产生的订单。</li>
<li><code>0</code>：挂单过期时间。这里设置为0，表示挂单不会过期。</li>
<li><code>clrGreen</code>：订单在图表上显示的颜色。</li>
</ul>
<p>如何要设置止盈和止损 要改动3后面两个0的位置为 <code>SL</code> <code>TP</code></p>
<p>如果你希望<strong>在下单手数大于1手时才使用止盈止损</strong>，<strong>手数小于等于1手时不使用止盈止损</strong>，那么可以在计算止损和止盈之前加入一个判断条件，如下所示：</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">extern double stopLoss = 1000; // 止损点数</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">extern double takeProfit = 1300; // 止盈点数</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 计算止损和止盈</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">double SL = 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">double TP = 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">if(CurrentBuyLotSize &gt; 1 || CurrentSellLotSize &gt; 1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    if(OrderSelect(0, SELECT_BY_POS, MODE_TRADES))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        if(OrderType() == OP_BUY)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            SL = BuyLimitPrice - stopLoss * Point;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            TP = BuyLimitPrice + takeProfit * Point;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        else if(OrderType() == OP_SELL)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            SL = SellLimitPrice + stopLoss * Point;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            TP = SellLimitPrice - takeProfit * Point;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 可以替换成其他条件判断语句</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int BuyTicket = OrderSend(Symbol(), OP_BUYLIMIT, CurrentBuyLotSize, BuyLimitPrice, 3, SL, TP, &quot;WinLimit-Buy&quot;, MagicNumber, 0, clrGreen);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int SellTicket = OrderSend(Symbol(), OP_SELLLIMIT, CurrentSellLotSize, SellLimitPrice, 3, SL, TP, &quot;WinLimit-Sell&quot;, MagicNumber, 0, clrRed);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>这样，在下单手数大于1手时，<code>SL</code>和<code>TP</code>的值会被计算出来 ，否则它们的值都为0，表示不使用止盈止损。</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="for循环的迷惑">for循环的迷惑<a href="#for循环的迷惑" class="hash-link" aria-label="for循环的迷惑的直接链接" title="for循环的迷惑的直接链接">​</a></h2>
<p><code>for(int i = OrdersTotal() - 1; i &gt;= 0; i--)与 for(int i = 0; i &lt; OrdersTotal(); i++)</code></p>
<p>这两个<code>for</code>循环的区别在于它们遍历订单的顺序不同。</p>
<ul>
<li><code>for(int i = OrdersTotal() - 1; i &gt;= 0; i--)</code>：这个循环是从最后一个订单开始，倒序遍历所有订单。</li>
<li><code>for(int i = 0; i &lt; OrdersTotal(); i++)</code>：这个循环是从第一个订单开始，顺序遍历所有订单。</li>
</ul>
<p>在某些情况下，遍历订单的顺序可能会影响策略的执行。例如，如果你在循环中删除了某个订单，那么使用倒序遍历可以避免因为订单索引改变而导致的问题。</p>
<p><code>为什么在定义删除所有订单closeAllOder()时，必须使用for(int i = OrdersTotal() - 1; i &gt;= 0; i--)</code></p>
<p>在定义删除所有订单的<code>closeAllOrder()</code>函数时，通常会使用<code>for(int i = OrdersTotal() - 1; i &gt;= 0; i--)</code>这种倒序遍历的方式，原因是当你删除一个订单时，<code>OrdersTotal()</code>的值会减少1，而且所有订单的索引也会发生变化。</p>
<p>如果你使用顺序遍历的方式，那么在删除一个订单后，下一个订单的索引会变成当前订单的索引，这样就会导致漏删订单。而使用倒序遍历的方式则不会出现这个问题，因为删除一个订单只会影响它后面的订单的索引，而不会影响它前面的订单。</p>
<p>举个例子，<strong>假设你有3个订单，它们的索引分别为0、1和2。如果你使用顺序遍历的方式，在删除索引为0的订单后，原本索引为1和2的订单现在变成了索引为0和1的订单。这样，在下一次循环中，你会跳过原本索引为1的订单，直接删除索引为1（原本为2）的订单。而如果你使用倒序遍历的方式，在删除索引为2的订单后，原本索引为0和1的订单仍然是索引为0和1，不会受到影响。</strong></p>
<blockquote>
<p>在大多数情况下，使用<code>for(int i = 0; i &lt; OrdersTotal(); i++)</code>顺序遍历和使用<code>for(int i = OrdersTotal() - 1; i &gt;= 0; i--)</code>倒序遍历都是可以的。只有在你需要对订单进行删除或修改操作时，才需要注意遍历的顺序。
如果只是想获取订单信息，而不需要对订单进行删除或修改操作，那么使用顺序遍历和倒序遍历都是可以的。例如，可以使用顺序遍历来统计当前所有订单的总盈亏。</p>
</blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">最后<!-- -->由 <b>joe</b> <!-- -->于 <b><time datetime="2024-08-07T06:35:05.000Z" itemprop="dateModified">2024年8月7日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/nytimes"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">纽时播报</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/nytimes/concise-vs-natrue"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">清晰简洁的语言和清晰自然的语言在翻译中都有其优点</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#关闭订单的函数ordercloseprice" class="table-of-contents__link toc-highlight">关闭订单的函数<code>OrderClosePrice()</code></a></li><li><a href="#设置止盈和止损" class="table-of-contents__link toc-highlight">设置止盈和止损</a></li><li><a href="#下单的函数及写法" class="table-of-contents__link toc-highlight">下单的函数及写法</a></li><li><a href="#for循环的迷惑" class="table-of-contents__link toc-highlight">for循环的迷惑</a></li></ul><a target="_blank" href="https://s.ifttt.fun/atfx" rel="noopener noreferrer"><img style="border:1px solid #ddd;box-shadow:0 2px 5px rgba(0, 0, 0, 0.1);padding:18px;border-radius:8px;background:white;margin-top:1.25em" class="size-full wp-image-24489 aligncenter" src="https://cdn.fendou.la/bluehost/ATFX-ads.svg" alt="ATFX侧边栏广告"></a><a href="https://s.ifttt.fun/jsmt4" target="_blank" rel="noopener noreferrer">嘉盛集团<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div></div></div></div></main></div></div></div></div>
</body>
</html>