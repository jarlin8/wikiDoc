---
title: EA相关参数设置
tags:
- EA
description: EA交易（Expert Advisor交易）是一种自动投资软件，由于它能够自动选择和执行交易，因此一直得到越来越多的应用和使用。EA交易的趋势显示，在过去的几年里，EA交易一直是受欢迎的投资工具，因为它能够为投资者提供更多的风险体系结构，更有效的风险控制能力以及更好的获利机会。随着越来越多的投资者意识到EA交易可以带来更多的优势，EA交易未来仍将继续受到投资者的青睐。
---

## EA跟单软件
对smartlimit进行限制以达到控制风险的目的，主要涉及跟单端参数较多，喊单端容易理解，不需多言。
```
使用时,必须在 常用 >> 实时自动交易 里面打开 []允许实时自动交易 复选框
```

### 基础设置
- 喊单账号   `填入对应账号,例如:37045769`
- 跟单手数比例   `0.01-100`
- 使用固定手数   `false/true`
- 固定跟单手数   `0.01-100`
- 总最大跟单手数   `100 实际用处有待挖掘`
- 止损点数   `与跟单账户的报价小数点位数有关 XAUUSD报价 1912.32 一美金波动为 100 1912.326 一美金波动为 1000`
- 止盈点数   `与止损点位类似`
- 净值低于平仓退出   `默认是5000,不想限制 一定要改成 0`

`********品种跟单比例单独设置********` 不做任何限制 目前只跟 XAUUSD

### 跟单限制设置
- 反向跟单开关   `false/true 反向跟数据行情很有用处`
- 跟单挂单开关   `false/true`
- 是否跟随平仓   `false/true`
- 跟多单   `false/true`
- 跟空单   `false/true`
- 跟主账号大于等于N的单子   `0.0 我的主账户都是1手起步,这里设置为 1`
- 跟主账号小于等于N的单子   `20 用于风控 正向跟单 4; 反向跟单 20`
- 主账号亏损多少后跟单      `跟扛单的主,这里用不到`
- 只跟货币名称（空为全跟）      `XAUUSD`
- 不跟货币名称      `留空`

### 后缀设置
- 喊单端后缀    `特殊账号的不同表示,用于区分 XAUUSDz XAUUSDr XAUUSD# GOLD GOLD# 只填z/r/#等`
- 跟单端后缀    `同上,但是跟单和喊单的前缀要一样,前缀不同的,用后面的特殊品种设置,此处留空`

### 跟单延迟设置
- 跟单延迟秒    `120,超过120s的单子不执行 留空`
- 跟单价格偏差  `200 此处没搞懂 留空`

### 时间限制设置
- 时间限制开关   `false/true`
- 时间模式   `本地时间/平台时间 我选本地时间,VPS在香港`
- 开始时间   `00:00:00`
- 结束时间   `23:59:59`

```
开始时间 < 结束时间
例如: 开始时间 00:00:00 结束时间 20:59:59 ✔
      开始时间 20:59:59 结束时间 03:00:00 ❌
```

### 特殊品种对应设置[补充后缀设置的不足]
- 特殊品种1     `XAUUSDz  喊单端后的品种代码`
- 对应品种1     `GOLD#  跟单端后的品种代码`

### 注释
可用于备注不同参数调整备忘, 或者打广告

## SmartLimit主程序设置
- Lots      `开仓基数 1 ；一手开始`
- addlot      `加仓基数 1 ；依次递增,递增基数为1`
- dispoint      `开仓间隔,同样跟平台的报价有关 小数点2位报价 120, 3位报价就是 1200`
- tpmoney       `赚多少点出局,1手波动2美金就是200`

## 当前配置&备注
### SmartLimit实战主程序[EXNESS 0点差账户]
- Lots      `1`
- addlot      `1`
- dispoint      `1200`
- tpmoney       `200`

### EA跟单软件 实战配置
#### 限制手数跑波动
- 喊单账号   `68009202`
- 跟单手数比例   `0.01`
- 使用固定手数   `false`
- 固定跟单手数   ` 空 `
- 总最大跟单手数   `100 `
- 止损点数   `6000`
- 止盈点数   `留空 主程序有出局机制`
- 净值低于平仓退出   `0` 保护机制

##### 跟单限制设置
- 反向跟单开关   `false`
- 跟单挂单开关   `false`
- 是否跟随平仓   `true`
- 跟多单   `true`
- 跟空单   `true`
- 跟主账号大于等于N的单子   `1`
- 跟主账号小于等于N的单子   `4`

#### 趋势剥头皮风控
- 喊单账号   `68009202`
- 跟单手数比例   `0.1` 10倍于跑波动的比例
- 使用固定手数   `false`
- 固定跟单手数   ` 空 `
- 总最大跟单手数   `100 ` 可不限制
- 止损点数   `留空 波动跟单有出局机制`
- 止盈点数   `750`
``` 有个750/1000的测试 ```
- 净值低于平仓退出   `0`

##### 跟单限制设置
- 反向跟单开关   `true`
- 跟单挂单开关   `true`
- 是否跟随平仓   `true`
- 跟多单   `true`
- 跟空单   `true`
- 跟主账号大于等于N的单子   `4`
- 跟主账号小于等于N的单子   `20`
```防止最后一笔单子 带来的大额亏损```

## 遇到的问题&解决方案

<details>
<summary>趋势引起的爆仓问题</summary>

限制[[ea-setup#限制手数跑波动|跑波段]]的最大跟单手数和止损

- 跟主账号大于等于N的单子   `1`
- 跟主账号小于等于N的单子   `4`
- 止损点数   `空` 由对冲解决

</details>

<details>
<summary>止损6000引起亏损较大无法盈利问题</summary>

用 [[ea-setup#趋势剥头皮风控|剥头皮]] 来对冲
- 跟主账号大于等于N的单子   `5` ?
- 跟主账号小于等于N的单子   `100` ?
- 止盈点数   `750`  有待测试 优化更改 ?

开仓基数 1 完全止损的亏损为 6000

| 开仓数 | 品种   | 开仓点位 | 出局点位 | 盈亏 |
| ------ | ------ | -------- | -------- | ---- |
| 1      | XAUUSD | 1924.656 | 1918.656 | 600  |
| 2      | XAUUSD | 1923.809 | 1917.809 | 1200 |
| 3      | XAUUSD | 1922.531 | 1916.531 | 1800 |
| 4      | XAUUSD | 1921.365 | 1915.365 | 2400 |

全部止损的前提是 6000/1200=5 开仓数到了 9 头皮盈亏图 

| 对应手数 |开仓数 | 品种   | 开仓点位 | 出局点位 | 盈亏 |
| :----: | :---: | :----: | :----: | :------: | :---: |
| 4      |  10  | XAUUSD | -------- | -------- | 1000 |
| 5      |  10  | XAUUSD | -------- | -------- | 1000 |
| 6      |  10  | XAUUSD | -------- | -------- | 1000 |
| 7      |  10  | XAUUSD | -------- | -------- | 1000 |
| 8      |  10  | XAUUSD | -------- | -------- | 1000 |
| 9      |  10  | XAUUSD | -------- | -------- | 1000/-3000 |

1. 盈利 1000*6 =6000  对冲 6000 总体亏损 0
2. 盈利 1000*5-3000=3000  对冲 3000 总体亏损 3000

</details>


### 止损与不止损的零界点

综合评估 : **不带止损点进行对冲跟单**  完美止盈 属于小概率事件

| 止损|+[部分对冲] | No. | 不止损 | 不止损/部分对冲 | 完美对冲(最后一单止盈) |
| ------ |---| ------------ | ------ | ---- | ---- |
| 200 |---|4   | 200    | --- | --- |
| 0 |[-2000] | **5**    | 0   | 0+0-2000=-2000     | 1*1000 |
| -1316-200=-1500 |[-2516] | 6 | -1316  | 1*1000-1316-2000=-2316 | 2*1000 |
| -2078-200*3=-2700 |[-2678] | 7 | -2078  | 2*1000-2078-2000=-2078  | 3*1000 |
| -2936-200*6=-4100 |[-3136] | 8 | -2936  | 3*1000-2936-2000=-1936  | 4*1000 |
| -3800-200*10=-5800 |[-3800] | 9 | -3800  | 4*1000-3800-2000=-1800  | 5*1000 |
| -6000[零界点]| [-3000] | **10**   | -4700  | 5*1000-4700-2000=-1700  | 6*1000 |
| -6000 |[-2000] | 11| -5600  | 6*1000-5600-2000=-1600  | 7*1000 |
| -6000 |[-2000] | 12| -6200  | 7*1000-6200-3000=-2200  | 8*1000 |
| -6000 |[-1900] | 13| -6984  | 8*1000-6984-4000=-2900   | 9*1000 |
| -6000 |[0] | 14| -7946  | 9*1000-7946-4000=-2000  | 10*1000|
| -6000 |[0] | 15| -8800  | 10*1000-8800-4000=-2800  | 11*1000|
| -6000 |[0] | 16| -9600 | 11*1000-9600-5000=-3600 | 12*1000|
| -6000 |[1000] | 17| -10300 | 12*1000-10300-5000=-3030 | 13*1000|
| -6000 |[2000] | 18| -11014 | 13*1000-11014-5000=-3000 | 14*1000|
| -6000 |[2000] | 19| -11600 | 14*1000-11600-6000=-3600 | 15*1000|
| -6000 |[2900] | 20| -12100 |15*1000-12100-6000=-3100|16*1000|

## 需要规避的问题
- 最后一单未止盈,且**多次**下单?
`设置最大跟单手数 20`;只能保证 20 以后的单子受到保护 且有反作用:超过20的时候,会增加亏损
4-20的单子怎么实现保护?

- 最后一单能否最小化回调?!!
 止盈点数750 只能增加触发到的机率,没触发的怎么办?
  尤其是 `4-5-6 ` 交易频率高的手数;
  现有程序无法解决,是否考虑自定其他程序解决

利用波动大小的概率 把对冲跟单[平台时间:00:00-19:59]的 范围 改成 5-100 **关注特殊时刻** 🎯 比如:非农 周四 周五 用财经日历 人工干预

**最终方案:** 利用带止损的  对冲掉 5-10 的亏损单子  正向剥头皮 10倍 1.1$   ❌

- [1-4]带止损6$  **[ 5-10 ] 止损比不止损 多亏 4000** `止损适合夜间行情 20:20-03:00 平台时间:12:10-19:59`

```
- 1-4 正常带止损6$ 不限时间跟单
- 5 6 7 正向10倍1$剥头皮止损1.2$[针对10 防止最后一笔单子无限亏损] 对冲止损 ❌过于理想的设定
- 5-100 反向10倍 0.75$剥头皮 5-10部分对冲正向头皮 10-100 赚取趋势利润
```
`不止损 适合白天行情 06:00-20:00 平台时间:00:00-12:00`

- [ 1-5 ] 不带止损跟单 [5-100]反向10倍1.1$剥头皮  大行情需要人工值守 🎯[**或者干脆限定时间**]

### 调到 1-5 正向跟单 部分对冲
|次数|1-4|1-5|
|:---:|:---:|:---:|
|5|-2000|-1800|
|6|-2316|-1716|
|7|-2078|-1800|
|8|-1936|-2200|
|9|-1800|-2500|
|10|-1700|-2800|

## 五星数据行情规避跟单损失

主程序数据是盈利状态,但是数据波动非常激烈,几毫秒的时间本来主城区已经盈利，但是跟单获利的时候却出现了很大的亏损,造成了不必要的损失.

而且这种数据行情 在对冲跟单的时候会造成订单无法执行或者相似订单同一点位多次执行的情况 使损失进一步扩大

`解决方法: 每周末列出当月的数据行情并添加闹钟提醒,停止前后半小时的跟单`

比如2月14号的21:30 美国一月末季调CPI月率 ⭐⭐⭐⭐⭐

## 2.18更新操作计划

|❌ 存在的问题|✔ 解决方案|
|:---:|:---:|
|跟单由于服务器原因造成亏损|Gold-EA/EA-GEN【香港/新加坡服务器】|
|小波动造成的亏损|1 4 7 10 13正常跟单 1倍【0.1】 比例跟单|
|数据行情极速跳动行情|直接停止【时间控制EA】 该时段的交易|
|半死不活的趋势行情 | >=1.6 【全部0.1倍跟单 .=0.16】 降低风险 |

---

| Gold-EA配置                  | EA-GEN配置+喊单端           | 修正后参数    |
| ---------------------------- | --------------------------- | --------------------------- |
| 0.1手 不限时间和手数上线的EA | 1 4 7 【1倍】               | 1-10【1倍】       |
|  | 10 13【1.3倍】止盈 回撤控制风险 | 13-40【0.1倍】 |
| SmartLimit 0.1 1200 180$     | 16 19 22 25 1.5倍 止盈 | 全部正向 |
|          ----                | 22-37 1.3倍 止盈            |             |

## 非农和五星数据行情规避 UFT+8
- 周四、周五 20:00-23:00 【夏令时】
- 周四、周五 21:00-00:00 【冬令时】

## 服务器时间改成UTF+9 东京时间
时间限制改成
- 00:00-21:00 正常倍数  [见2.18更新操作计划]
- 21:10-23:59 反向趋势跟单【0.1起步 1000止盈】 控制时间EA 相应时间段 直接停止
- 美国夏令时 主服务器用东京时间 UTF+9
- 美国冬令时 主服务器用北京/香港/新加坡时间 UTF+8

## 给EA加上止盈止损

当前EA具备的条件是 1、4、7、10是间隔3递增很好的适应了震荡行情；10以上是1.5倍递增，尽量缩短`closeallorders()`的时间周期，避免大量订单累积造成爆仓。

跟单出现的问题：
- 10以下使用1、4、7、10是间隔3递增，防止跳涨跳跌，设置了2000止盈和6000点止损
      - 没有达到盈利目标 1、4、7、10全部6000点止损了 亏损巨大
- 10以上使用的是20的固定手数跟，止盈止损均为1300
      - 回调<1300 触及不到止盈的小回调，造成多次硬止损 多次累积造成大亏损
！！！ 当上面两种情况同时出现的时候 当天的亏损就非常大。

### 解决方案
#### 主程序解决方案：
>  - 1、4、7、10间隔3递增 **止盈1300 止损6000**
>  - 10以上1.5倍递增 止盈1000 不止损

### 跟单程序解决方案
>  - 10以下使用固定比例跟单 **2000止盈和6000点止损** 不变
>  - 10以上使用20的固定手数跟，**止盈止损均为1300**

## 代码修改部分
[[nytimes/MQ4各种函数参数笔记##设置止盈和止损|设置止盈和止损]]有示例代码段。
```c++
//放在全局可自定义部分
extern double stopLoss = 6000; // 止损点数
extern double takeProfit = 1000; // 止盈点数
```

会出现的异常：
所有已成交订单都被止盈，还有挂单吊着。
在利润不达标那个条件判断中加上一条，`当没有买单或卖单且买入限价单的手数等于卖出限价但手术的时候就平掉所有订单`。等待测试结果。

下单与止盈止损手数一切正常。
测试中的EA名 `WinLimit` 与 `GoldLimit`